#!/bin/bash

# Script de configura√ß√£o para Railway - Ana Cardoso Bot v2
set -e

echo "üöÄ Configurando projeto Railway para Ana Cardoso Bot..."
echo "üìç Projeto: ana-cardoso-bot-v2"
echo "üåê GitHub: https://github.com/OctaDigital01/ana-cardoso-bot"
echo "üöÇ Railway: https://railway.com/project/2e7a4879-f9a3-40d7-89b6-4339e3c5e6ac"
echo ""

# NOVO PROJETO IDs - Ser√° necess√°rio atualizar ap√≥s criar os servi√ßos
PROJECT_ID="2e7a4879-f9a3-40d7-89b6-4339e3c5e6ac"

echo "üîß INSTRU√á√ïES PARA CONFIGURA√á√ÉO MANUAL NO RAILWAY:"
echo ""
echo "1. Acesse o projeto Railway:"
echo "   https://railway.com/project/2e7a4879-f9a3-40d7-89b6-4339e3c5e6ac"
echo ""
echo "2. Adicione os seguintes servi√ßos clicando em '+ New':"
echo "   a) PostgreSQL Database"
echo "   b) Redis Database"
echo "   c) Backend Service (conectar ao GitHub repo: backend folder)"
echo "   d) Frontend Service (conectar ao GitHub repo: frontend folder)"
echo ""
echo "3. Configurar vari√°veis de ambiente:"
echo ""

echo "üìä POSTGRESQL VARIABLES:"
echo "   POSTGRES_DB=telegram_bot_saas"
echo "   POSTGRES_USER=postgres" 
echo "   POSTGRES_PASSWORD=TelegramBotSaas2024_"
echo "   PGDATA=/var/lib/postgresql/data/pgdata"
echo ""

echo "üóÑÔ∏è REDIS VARIABLES:"
echo "   REDIS_PASSWORD=TelegramBotRedis2024_"
echo ""

echo "‚ö° BACKEND SERVICE VARIABLES:"
echo "   NODE_ENV=production"
echo "   PORT=3333"
echo "   DATABASE_URL=\${{Postgres.DATABASE_URL}}"
echo "   REDIS_URL=\${{Redis.REDIS_URL}}"
echo "   JWT_SECRET=telegram-bot-manager-super-secret-jwt-key-production-32-chars"
echo "   JWT_REFRESH_SECRET=telegram-bot-manager-super-secret-refresh-key-production-32-chars"
echo "   ENCRYPTION_KEY=telegrambotmanager32charkey12345"
echo "   TELEGRAM_WEBHOOK_DOMAIN=\${{RAILWAY_STATIC_URL}}"
echo "   FRONTEND_URL=[FRONTEND_SERVICE_URL]"
echo "   RATE_LIMIT_WINDOW=60000"
echo "   RATE_LIMIT_MAX=1000"
echo "   LOG_LEVEL=info"
echo "   ENABLE_REGISTRATION=true"
echo "   ENABLE_SWAGGER=false"
echo ""

echo "üé® FRONTEND SERVICE VARIABLES:"
echo "   NODE_ENV=production"
echo "   PORT=3000"
echo "   NEXT_PUBLIC_API_URL=\${{Backend.RAILWAY_STATIC_URL}}/api/v1"
echo "   NEXT_PUBLIC_WS_URL=wss://\${{Backend.RAILWAY_STATIC_URL}}"
echo "   NEXT_PUBLIC_APP_URL=\${{RAILWAY_STATIC_URL}}"
echo "   NEXT_PUBLIC_APP_NAME=Ana Cardoso Bot Manager"
echo "   NEXT_PUBLIC_ENABLE_PWA=true"
echo "   NEXT_PUBLIC_ENABLE_ANALYTICS=true"
echo "   NEXT_TELEMETRY_DISABLED=1"

echo ""
echo "4. CONFIGURA√á√ÉO DOS SERVI√áOS:"
echo ""
echo "   Para BACKEND SERVICE:"
echo "   - Root Directory: /backend"
echo "   - Build Command: npm run build"  
echo "   - Start Command: node dist/server.js"
echo ""
echo "   Para FRONTEND SERVICE:"
echo "   - Root Directory: /frontend"
echo "   - Build Command: npm run build"
echo "   - Start Command: npm start"
echo ""

echo "5. AP√ìS CONFIGURAR TUDO:"
echo "   - Deploy todos os servi√ßos"
echo "   - Configurar dom√≠nios customizados se necess√°rio"
echo "   - Testar as URLs geradas"
echo ""

echo "üìã CHECKLIST DE DEPLOYMENT:"
echo "   ‚ñ° PostgreSQL adicionado e rodando"
echo "   ‚ñ° Redis adicionado e rodando"  
echo "   ‚ñ° Backend conectado ao GitHub e rodando"
echo "   ‚ñ° Frontend conectado ao GitHub e rodando"
echo "   ‚ñ° Todas as vari√°veis configuradas"
echo "   ‚ñ° URLs funcionando corretamente"
echo ""

echo "üéØ IMPORTANTE:"
echo "   - Substitua [FRONTEND_SERVICE_URL] pela URL real do frontend ap√≥s deploy"
echo "   - Configure seu TELEGRAM_BOT_TOKEN nas vari√°veis do backend"
echo "   - Use \${{SERVICE_NAME.VARIABLE}} para refer√™ncias entre servi√ßos"
echo ""

echo "üéâ Configura√ß√£o preparada!"
echo "üìä Dashboard: https://railway.com/project/$PROJECT_ID"
echo "üåê GitHub: https://github.com/OctaDigital01/ana-cardoso-bot"